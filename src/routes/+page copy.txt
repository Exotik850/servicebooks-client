<script lang='ts'>
    // @ts-nocheck
    import TitleBar from '../components/TitleBar.svelte'
    import { enhance } from '$app/forms';
    import type { ActionData } from './$types';
    import { invoiceSchema } from '$lib/invoiceSchema';
    export let form: ActionData;
    $: console.log(form)

    let invoice = {};    

    function snakeToTitleCase(text: string): string {
        const words = text.split('_');
        for (let i = 0; i < words.length; i++) {
            words[i] = words[i][0].toUpperCase() + words[i].slice(1).toLowerCase();
        }
        return words.join(' ');
    }

    let titleButton = {
        icon: 'https://icons8.com/icon/100066/1',
        onClick: () => {},
        href: '/',
    }

</script>
<TitleBar/>
<article>
    <form use:enhance method="POST">

    {#each Object.keys(invoiceSchema.shape) as key, i}
        <label for={key} name={key}>{snakeToTitleCase(key)}
            <input required name={key}>
        </label>
    {/each}

    {#if form?.packet.error}
        <div class="notice-error" aria-invalid="true">
        {#each form.packet.errors as error}
            <li>{snakeToTitleCase(error.field)} : {error.message}</li>
        {/each}
        </div>
    {/if}

    <button type="submit">Submit</button>

    </form>
</article>